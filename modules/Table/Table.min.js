var table={formName:"",urlAjax:"ajax.php",titoli:["titolo"],data:[["link",["a"]],["b",["b"]],["c",["c"]]],visibili:[["","","","",""],["","hide","hide","hide","hide"]],buttons:['<button type="button" class="btn btn-default disable">Disabilita</button>','<button type="button" class="btn btn-default modify">Modifica</button>','<button type="button" class="btn btn-default delete">Remove</button>']};$(document).ready(function(){drawTable();$(".table-page").change(function(b){var a=newPagePath($(this).val());window.location.search=a;window.location.href})});function drawTable(){makeTable("#table",table.titoli,table.data,table.visibili[0])}function makeTable(a,k,d,c){var h=12;h=Math.floor(12/k.length);var m="";var b=new Form();m+='<div class="table row"><div class="col-xs-12"><div class="row table-header">';for(var f=0;f<k.length;f++){m+='<div class="table-col col-xs-'+h+" "+c[f]+'">'+b.parsingName(k[f])+"</div>"}m+='</div></div><div class="col-xs-12 table-body">';var l=0;var g=0;for(var f=0;f<d.length;f++){if(g<d[f][1].length){g=d[f][1].length}}h=Math.floor(12/g);for(var f=0;f<d.length;f++){m+='<div class="row table-id table-row-'+((l++)%2)+'"><a pos="'+f+'" href="'+d[f][0]+'" OnClick="formModal('+f+')" class="'+d[f][2]+'">';for(var e=0;e<d[f][1].length;e++){m+='<div class="table-col col-xs-'+h+" "+c[e]+'">'+d[f][1][e]+"</div>"}m+="</a></div>"}m+='</div><div class="col-xs-12 table-page-content"><b>Page: </b><select class="table-page">';for(var f=0;f<table.nPage;f++){if(f==table.currentPage){m+='<option value="'+f+'" selected>'+(f+1)+"</option>"}else{m+='<option value="'+f+'">'+(f+1)+"</option>"}}m+="</select></div>";"</div>";$(a).html(m)}function formModal(e){var f;var g="";var a=new Form();console.log(table.bigData[e]);var d=findActive(table.bigData[e]);var b=table.buttons.slice();if(d!=false){if(d.val=="1"){b.splice(0,1)}else{b.splice(1,1)}}a.initObj(table.bigData[e],table.formName);g=a.draw();var c=b.join(" ")+" ";clearDialog("#modalInfo");$("#modalInfo").find(".modal-title").html("Dettaglio");$("#modalInfo").find(".modal-data").html(g);$("#modalInfo").find(".modal-footer").prepend(c);$("#modalInfo").modal();$(".btn-modify").click(function(h){modify(this)});$(".btn-disable").click(function(h){disable(this)});$(".btn-delete").click(function(h){remove(this)})}function findActive(b){var c=false;for(var a=0;a<b.length;a++){if(b[a].name=="flag_active"){c=b[a]}}return c}function disable(c){var a=$(c).attr("form");var b=$(c).attr("t");modifyTable("disable",a,b)}function modify(c){var a=$(c).attr("form");var b=$(c).attr("t");modifyTable("modify",a,b)}function remove(c){var a=$(c).attr("form");var b=$(c).attr("t");modifyTable("delete",a,b)}function modifyTable(a,g,c){var b="";var f="";var e="";var h=[];var d="";$('[form="'+g+'"]').each(function(i,j){if(!($(j).is("a")||$(j).is("div"))){b=$(j).attr("id");f=$(j).val();if($(j).is("input")&&$(j).attr("type")=="number"){e="number"}else{e="string"}h.push({name:b,type:e,val:f})}});d=JSON.stringify({table:c,fields:h});$.post("ajax.php",{action:a,data:d},function(i,k,j){if(i=="true"){out(button.mex[0],1);setTimeout(function(){document.location.reload(true)},500)}else{out(button.mex[1],3)}})}function postEffectTable(a,b){console.log(a);console.log(b)}function newPagePath(a){var d=window.location.search;d=d.split("?")[1];d=d.split("&");var b=[];var e=false;for(var c=0;c<d.length;c++){b.push(d[c].split("="))}for(var c=0;c<b.length;c++){if(b[c][0]=="p"){e=true;b[c][1]=a}}if(!e){b.push(["p",a])}d=[];for(var c=0;c<b.length;c++){d.push(b[c].join("="))}d=d.join("&");d="?"+d;return d};